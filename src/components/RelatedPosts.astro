---
import { FaRotate } from 'react-icons/fa6'
import { getCollection } from 'astro:content'
import { Image } from 'astro:assets'
import dayjs from 'dayjs'
import defaultHeroImage from '../assets/default-hero-image.png'

const posts = await getCollection('blog')
const relatedPosts = posts.sort(() => Math.random() - 0.5).slice(0, 5)
---

<div class="rounded-md bg-slate-800 p-3">
  {
    relatedPosts.map((post) => (
      <a href={`/${post.slug}/`} class="flex rounded-md p-3 duration-500 hover:bg-slate-700">
        <Image src={(post.data.heroImage as ImageMetadata) || defaultHeroImage} alt="" class="mr-3 w-1/3 rounded-md" />
        <div class="truncate">
          <div class="mb-3 truncate">{post.data.title}</div>
          <div class="flex items-center justify-end">
            <FaRotate className="inline" />
            &nbsp;
            {dayjs(post.data.updatedAt).format(`YYYY-MM-DD`)}
          </div>
        </div>
      </a>
    ))
  }
</div>
